<header class="header-bar">
  <div class="header-content">
    <nav class="breadcrumb-nav" *ngIf="breadcrumbs.length > 0">
      <ol class="breadcrumb-list">
        <li class="breadcrumb-item">
          <a routerLink="/" class="breadcrumb-link">
            <i class="fa fa-home"></i>
          </a>
        </li>
        @for (breadcrumb of breadcrumbs; track breadcrumb.url; let isLast =
        $last) {
        <li class="breadcrumb-item">
          <span class="breadcrumb-separator">
            <i class="fa fa-chevron-right"></i>
          </span>
          @if (!isLast) {
          <a [routerLink]="breadcrumb.url" class="breadcrumb-link">
            {{ breadcrumb.label }}
          </a>
          } @else {
          <span class="breadcrumb-current">{{ breadcrumb.label }}</span>
          }
        </li>
        }
      </ol>
    </nav>

    <div class="user-profile" *ngIf="currentUser">
      <button
        class="profile-button"
        (click)="toggleProfileMenu()"
        [class.active]="showProfileMenu"
      >
        <span class="user-initials">{{ getUserInitials() }}</span>
        <span class="user-name"
          >{{ currentUser.first_name }} {{ currentUser.last_name }}</span
        >
        <i
          class="fa fa-chevron-down dropdown-icon"
          [class.rotated]="showProfileMenu"
        ></i>
      </button>

      @if (showProfileMenu) {
      <div class="profile-menu">
        <div class="profile-menu-header">
          <div class="profile-avatar-large">{{ getUserInitials() }}</div>
          <div class="profile-info">
            <p class="profile-name">
              {{ currentUser.first_name }} {{ currentUser.last_name }}
            </p>
            <p class="profile-username">{{ currentUser.username }}</p>
          </div>
        </div>
        <div class="profile-menu-divider"></div>
        <ul class="profile-menu-list">
          <li>
            <a
              routerLink="/profile"
              class="profile-menu-item"
              (click)="closeProfileMenu()"
            >
              <i class="fa fa-user"></i>
              <span>My Profile</span>
            </a>
          </li>
          <li>
            <a
              routerLink="/settings"
              class="profile-menu-item"
              (click)="closeProfileMenu()"
            >
              <i class="fa fa-cog"></i>
              <span>Settings</span>
            </a>
          </li>
        </ul>
        <div class="profile-menu-divider"></div>
        <ul class="profile-menu-list">
          <li>
            <a class="profile-menu-item logout" (click)="logout()">
              <i class="fa fa-sign-out-alt"></i>
              <span>Logout</span>
            </a>
          </li>
        </ul>
      </div>
      }
    </div>
  </div>
</header>

@if (showProfileMenu) {
<div class="profile-menu-backdrop" (click)="closeProfileMenu()"></div>
}
